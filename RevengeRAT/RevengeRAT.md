# Brbbot.exe

| Malware Name | File Type | SHA256 |
| --- | ----------- | ----------- |
| Revenge RAT | vbs | 35513e333c1138e4e1199640d44ea9eca3c91deb6c485f828c898a4e76ab5af5 |


## Analysis process

This infection started from a suspicious email with a link to a file hosted on Onedrive. the downloaded file is a VBS file:

![i](/Brbbot/img/1.PNG)

The content is highly obfuscated:

![i](/Brbbot/img/2.png)

Here i used [CMDWatcher](https://www.kahusecurity.com/posts/cmd_watcher_updated.html) in interactive mode in order to catch suspicious process spawns:

![i](/Brbbot/img/3.png)

We see that the malware dropped a Powershell script to `AppData\local\temp`. opening it in Powershell_ise:

![i](/Brbbot/img/4.png)

The one main thing that caught my eyes immediately was 2 long byte arrays: "RunPE" and "Bytes". of course there are a bunch of other interesting stuff but we'll be back to that little later. 

I dropped the two files to disk using Powershell:

![i](/Brbbot/img/5.png)

Observing the "Bytes" file reveals that it is a PE File:

![i](/Brbbot/img/6.png)

Checking the signature:

![i](/Brbbot/img/7.png)

So, Dropping it to ILSpy:

![i](/Brbbot/img/8.png)

And here is the malware config :)

![i](/Brbbot/img/10.png)

> We see That this is the "Revenge RAT".

Qhick googling takes us to the exact repo that this code is taken from:

![i](/Brbbot/img/12.png)

> c2: h0pe1759.ddns.net

The code contains a lot of capabilities like taking screenshots, retrieve information, get installed AV and more (thanks to the malware developer for the detailed documentation :))

![i](/Brbbot/img/9.png)

The other file that dropped to disk is a compressed Csharp code that gets compiled at runtime, and his purpose is to RunPE (AKA process hollowing) the RAT inside the legit InstallUtil.exe Binary (in this case):

![i](/Brbbot/img/11.png)

While writing these letters i found out a [detailed Blogpost](https://blog.morphisec.com/revealing-the-snip3-crypter-a-highly-evasive-rat-loader) on that exact infection by Morphysec. 




