# Revenge RAT

| Malware Name | File Type | SHA256 |
| --- | ----------- | ----------- |
| Revenge RAT | vbs | 35513e333c1138e4e1199640d44ea9eca3c91deb6c485f828c898a4e76ab5af5 |


## Analysis process

This infection started from a suspicious email with a link to a file hosted on Onedrive. the downloaded file is a VBS file:

<img src="/RevengeRAT/img/1.PNG" width=10% height=10%>

The content is highly obfuscated:

![i](/RevengeRAT/img/2.PNG)

Here i used [CMDWatcher](https://www.kahusecurity.com/posts/cmd_watcher_updated.html) in interactive mode in order to catch suspicious process spawns:

![i](/RevengeRAT/img/3.PNG)

We see that the malware dropped a Powershell script to `AppData\local\temp`. opening it in Powershell_ise:

![i](/RevengeRAT/img/4.PNG)

The one main thing that caught my eyes immediately was 2 long byte arrays: "RunPE" and "Bytes". of course there are a bunch of other interesting stuff but we'll be back to that little later. 

I dropped the two files to disk using Powershell:

<img src="/RevengeRAT/img/5.PNG" width=80% height=80%>

Observing the "Bytes" file reveals that it is a PE File:

![i](/RevengeRAT/img/6.PNG)

Checking the signature:

<img src="/RevengeRAT/img/7.PNG" width=50% height=50%>

So, Dropping it to ILSpy:

![i](/RevengeRAT/img/8.PNG)

And here is the malware config :)

![i](/RevengeRAT/img/10.PNG)

> We see That this is the "Revenge RAT".

Qhick googling takes us to the exact repo that this code is taken from:

![i](/RevengeRAT/img/12.PNG)

> c2: h0pe1759.ddns.net

The code contains a lot of capabilities like taking screenshots, retrieve information, get installed AV and more (thanks to the malware author for the detailed documentation :kissing_heart:)

![i](/RevengeRAT/img/9.PNG)

The other file that dropped to disk is a compressed Csharp code that gets compiled at runtime, and his purpose is to RunPE (AKA process hollowing) the RAT inside the legit InstallUtil.exe Binary (in this case):

<img src="/RevengeRAT/img/10.PNG" width=100% height=100%>

While writing these letters i found out a [detailed Blogpost](https://blog.morphisec.com/revealing-the-snip3-crypter-a-highly-evasive-rat-loader) on that exact infection by Morphysec. 




